[H2modesa, H1_2modesa, H2_2modesa, Hu2modesa, H1u2modesa, H2u2modesa, Hoperations2modesa, fcouplingOp2modesa] = generateH2mode_gen(0.2/g2GHz, 1/sqrt(2), 1, 15);
options_gate4 = optionsOCqn(1e-4, 1e4);
options_gate4.f_max_alpha = get_f_max_alphaOCf_multiE(0.2/0.03, 0.01*2*pi, 2.8*2*pi, @(w)320/0.03*0.5*(1-tanh(0.6*(w-0.25/0.03))), 2);
[fieldt2mb, fieldw2mb, psi2mb, relE2mb, conv2mb, niter2mb, mallniterc2mb, Jterms2mb, maxgrad2mb, alpha2mb, invHess2mb] = OClimf_gate(u02modes, target2modes, [1 5 9], Hoperations2modesa, 2, fcouplingOp2modesa, [-25 35], @(w)0.05*0.5*(1-tanh(0.6*(w-0.25/0.03))).*sin(2*pi*w/0.25*0.03), @(w)100/0.03*0.5*(1-tanh(0.6*(w-0.25/0.03))), options_gate4, 2.8*2*pi, 1e-2*2*pi, 9, 9, 1e-6);
[fieldt2mb1, fieldw2mb1, psi2mb1, relE2mb1, conv2mb1, niter2mb1, mallniterc2mb1, Jterms2mb1, maxgrad2mb1, alpha2mb1, invHess2mb1] = OClimf_gate(u02modes, target2modes, [1 5 9], Hoperations2modesa, 2, fcouplingOp2modesa, [-25 35], @(w)0.05*0.5*(1-tanh(0.6*(w-0.25/0.03))).*sin(2*pi*w/0.25*0.03), @(w)100/0.03*0.5*(1-tanh(0.6*(w-0.25/0.03))), options_gate4, 2.8*2*pi, 1e-2*2*pi, 9, 9, 1e-6);
[fieldt2mb2, fieldw2mb2, psi2mb2, relE2mb2, conv2mb2, niter2mb2, mallniterc2mb2, Jterms2mb2, maxgrad2mb2, alpha2mb2, invHess2mb2] = OClimf_gate(u02modes, target2modes, [1 5 9], Hoperations2modesa, 2, fcouplingOp2modesa, [-25 35], fieldw2mb1, @(w)300/0.03*0.5*(1-tanh(0.6*(w-0.25/0.03))), options_gate4, 2.8*2*pi, 1e-2*2*pi, 9, 9, 1e-6);
