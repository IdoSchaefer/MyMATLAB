m = (0:8).';
dphi = pi/32;
phi = (0:dphi:(2*pi- dphi)).';
N = 1/sqrt(sum(exp(-((m-4).^2/4))));
chi = 1/sqrt(2*pi)*exp(1i*phi*m.');
psiE0 = N*exp(-(m-4).^2/8);
plot(m, psiE0.^2);
psi0 = chi*psiE0;
plot(phi, psi0.*conj(psi0))
r = 3;
E = m.^2/(2*r^2);
dt = pi/(E(end)*4);
t = 0:dt:2*pi/E(2);
propagation_factor = exp(-1i*E*t);
psiE = psiE0.*propagation_factor;
psi = chi*psiE;
H = diag(E);
Lz = diag(m);
evH = real(sum(conj(psiE).*(H*psiE)));
evLz = real(sum(conj(psiE).*(Lz*psiE)));
Xmat = r/2*(diag(ones(8,1), 1));
Xmat = Xmat + Xmat';
Ymat = 1i*r/2*(diag(-ones(8,1), -1) + diag(ones(8,1), 1));
evX = real(sum(conj(psiE).*(Xmat*psiE)));
evY = real(sum(conj(psiE).*(Ymat*psiE)));
A_Bohr = r*psiE0(1:8).*psiE0(2:9);
omegaBohr = (2*m(1:8) + 1)/(2*r^2);
evX1 = sum(A_Bohr.*(cos(omegaBohr*t)));
evY1 = sum(A_Bohr.*(sin(omegaBohr*t)));
evX2 = 3*sum(cos(phi).*(psi.*conj(psi)))*dphi;
evY2 = 3*sum(sin(phi).*(psi.*conj(psi)))*dphi;
xt = r*cos(4/9*t);
yt = r*sin(4/9*t);
